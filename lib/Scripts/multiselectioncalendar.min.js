(function(){"use strict";var u={},f,e,o,i,t,n,s,r,h;global.MultiSelectionCalendar=global.MultiSelectionCalendar||{};ss.initAssembly(u,"multiselectioncalendar");f=function(n,t,i,r,u){this.$1$IdField=0;this.$1$XIdxField=0;this.$1$YIdxField=0;this.$1$DateField=new Date(0);this.$1$TdElementField=null;this.$dayFieldClass=null;this.$1$DivElementField=null;this.$1$IsMouseEventBoundField=!1;this.set_$id(n);this.set_$xIdx(t);this.set_$yIdx(i);this.set_$date(r);this.$dayFieldClass=u};f.__typeName="MultiSelectionCalendar.$DayField";f.$ctor1=function(n,t,i,r,u){this.$1$IdField=0;this.$1$XIdxField=0;this.$1$YIdxField=0;this.$1$DateField=new Date(0);this.$1$TdElementField=null;this.$dayFieldClass=null;this.$1$DivElementField=null;this.$1$IsMouseEventBoundField=!1;this.set_$id(n);this.set_$xIdx(t);this.set_$yIdx(i);this.set_$date(r);this.$dayFieldClass=new e(u)};e=function(n){(this.$1$IsSelectedMonthField=!1,this.$1$IsEnabledDayField=!1,this.$1$SelectionIdxField=0,ss.isNullOrUndefined(n))||(this.set_$isSelectedMonth(ss.startsWithString(n,"cm")),this.set_$isEnabledDay(n.indexOf("e")!==-1),n.length>3&&n.charCodeAt(n.length-2)===115&&this.set_$selectionIdx(parseInt(String.fromCharCode(n.charCodeAt(n.length-1)))))};e.__typeName="MultiSelectionCalendar.$DayFieldClassAttribute";e.$ctor1=function(n,t,i){this.$1$IsSelectedMonthField=!1;this.$1$IsEnabledDayField=!1;this.$1$SelectionIdxField=0;this.set_$isSelectedMonth(n);this.set_$isEnabledDay(t);this.set_$selectionIdx(i)};o=function(){};o.__typeName="MultiSelectionCalendar.$Program";o.$main=function(){t.init()};i=function(){};i.__typeName="MultiSelectionCalendar.Calendar";i.getDateRangesFromString=function(n){var u=[],o,f,e,s,h;if(ss.isNullOrUndefined(n))return u.push(new r(new Date(1940,0,1),new Date(2100,0,1),0)),u;for(o=n.split(String.fromCharCode(59)),f=0;f<o.length;f++){var l=o[f],t=l,c={$:0};t.length>1&&t.charCodeAt(1)===58&&(ss.Int32.tryParse(String.fromCharCode(t.charCodeAt(0)),c),t=t.substring(2));e=t.split(String.fromCharCode(45));e.length===2&&(s=i.$parseExact(e[0],"dd.MM.yyyy"),h=i.$parseExact(e[1],"dd.MM.yyyy"),ss.isValue(s)&&ss.isValue(h)&&u.push(new r(ss.unbox(s),ss.unbox(h),c.$)))}return u};i.getStringFromDateRanges=function(n){for(var r,t=new ss.StringBuilder,f=!0,u=0;u<n.length;u++)r=n[u],f?f=!1:t.append(";"),t.append(r.get_selectionIdx()),t.append(":"),t.append(i.$dateToString(r.get_start(),"dd.MM.yyyy")),t.append("-"),t.append(i.$dateToString(r.get_end(),"dd.MM.yyyy"));return t.toString()};i.$parseExact=function(n,t){return ss.parseExactDate(n,t)};i.$dateToString=function(n,t){return ss.formatDate(n,t)};global.MultiSelectionCalendar.Calendar=i;t=function(n){this.$1$CalendarIdField=0;this.$1$CalendarRootElementField=null;this.$_currentEnabledRangesAsString=null;this.$_currentValueOfInputElement=null;this.$_dayFields=[];this.$_enabledRanges=null;this.$_endSelectionField=null;this.$_eventsBoundAfterCalenderInitialized=!1;this.$_eventsBoundAfterMonthNavigation=!1;this.$_firstDayOfActiveMonth=new Date(0);this.$1$InputElementField=null;this.$_isMouseInsideCalendar=!1;this.$_isSelectionModeOn=!1;this.$_lastEnteredDayField=null;this.$_mousePosY=0;this.$_rowHeight=0;this.$_scrollerIsRunning=!1;this.$_startSelectionField=null;this.$_tBody=null;this.$_weekSelectionModeActive=null;this.set_$calendarId(n)};t.__typeName="MultiSelectionCalendar.MultiSelectionCalendar";t.init=function(){var u,o;n.set_currentLanguageIsoCode(t.$getLanguageIsoCodeFromHiddenInputEelement());t.$_weekdayNames=[n.get_monday(),n.get_tuesday(),n.get_wednesday(),n.get_thursday(),n.get_friday(),n.get_saturday(),n.get_sunday()];var s=$("input.multiSelectionCalendar"),h=0,e=s.get();for(u=0;u<e.length;u++){var f=e[u],r=ss.cast(f,ss.isValue(f)&&ss.isInstanceOfType(f,Element)&&f.tagName==="INPUT"),c=h++,i=new t(c);t.$calendars.push(i);i.$modifyHtml(r);o=ss.cast(r.parentElement,ss.isValue(r.parentElement)&&ss.isInstanceOfType(r.parentElement,Element)&&r.parentElement.tagName==="DIV");i.set_$calendarRootElement(o);i.set_$inputElement(r);i.$updateEnableStatusOfMonthNavigation();i.$updateDayFieldsMap();i.$bindEvents(!0)}};t.getDateRangesFromString=function(n){return i.getDateRangesFromString(n)};t.getStringFromDateRanges=function(n){return i.getStringFromDateRanges(n)};t.$appendLin=function(n,t,i){n.appendLine(ss.formatString.apply(null,[t].concat(i)))};t.$getLanguageIsoCodeFromHiddenInputEelement=function(){var n=Enumerable.from($("input.multiSelectionCalendar").get()).select(function(n){return ss.cast(n,Object)}).firstOrDefault(null,ss.getDefaultValue(Object));return ss.isValue(n)?ss.coalesce(n.getAttribute("language"),""):""};t.$getNameOfMonth=function(t){switch(t){case 1:return n.get_january();case 2:return n.get_february();case 3:return n.get_march();case 4:return n.get_april();case 5:return n.get_may();case 6:return n.get_june();case 7:return n.get_july();case 8:return n.get_august();case 9:return n.get_september();case 10:return n.get_october();case 11:return n.get_november();case 12:return n.get_december();default:return t.toString()}};t.$isInRanges=function(n,t){return Enumerable.from(n).any(function(n){return t>=n.get_start()&&t<=n.get_end()})};global.MultiSelectionCalendar.MultiSelectionCalendar=t;n=function(){};n.__typeName="MultiSelectionCalendar.MultiSelectionCalendarResource";n.$getString=function(t){var i;return typeof global.MultiSelectionCalendar.Strings[n.get_currentLanguageIsoCode()]!="undefined"&&(i=global.MultiSelectionCalendar.Strings[n.get_currentLanguageIsoCode()][t],ss.isValue(i))?i:global.MultiSelectionCalendar.Strings["default"][t]};n.get_currentLanguageIsoCode=function(){return n.$1$CurrentLanguageIsoCodeField};n.set_currentLanguageIsoCode=function(t){n.$1$CurrentLanguageIsoCodeField=t};n.get_april=function(){return n.$getString("april")};n.get_august=function(){return n.$getString("august")};n.get_december=function(){return n.$getString("december")};n.get_february=function(){return n.$getString("february")};n.get_friday=function(){return n.$getString("friday")};n.get_hintNextMonth=function(){return n.$getString("hintnextmonth")};n.get_hintPreviousMonth=function(){return n.$getString("hintpreviousmonth")};n.get_january=function(){return n.$getString("january")};n.get_july=function(){return n.$getString("july")};n.get_june=function(){return n.$getString("june")};n.get_march=function(){return n.$getString("march")};n.get_may=function(){return n.$getString("may")};n.get_monday=function(){return n.$getString("monday")};n.get_november=function(){return n.$getString("november")};n.get_october=function(){return n.$getString("october")};n.get_saturday=function(){return n.$getString("saturday")};n.get_september=function(){return n.$getString("september")};n.get_sunday=function(){return n.$getString("sunday")};n.get_thursday=function(){return n.$getString("thursday")};n.get_tuesday=function(){return n.$getString("tuesday")};n.get_wednesday=function(){return n.$getString("wednesday")};global.MultiSelectionCalendar.MultiSelectionCalendarResource=n;s=function(n,t){this.$1$XField=0;this.$1$YField=0;this.set_x(n);this.set_y(t)};s.__typeName="MultiSelectionCalendar.Position";global.MultiSelectionCalendar.Position=s;r=function(n,t,i){this.$1$StartField=new Date(0);this.$1$EndField=new Date(0);this.$1$SelectionIdxField=0;this.set_start(new Date(n.getFullYear(),n.getMonth(),n.getDate()));this.set_end(new Date(t.getFullYear(),t.getMonth(),t.getDate()));this.set_selectionIdx(i)};r.__typeName="MultiSelectionCalendar.Range";global.MultiSelectionCalendar.Range=r;h=function(n,t,i,r){this.$1$TopField=0;this.$1$RightField=0;this.$1$BottomField=0;this.$1$LeftField=0;this.set_top(n);this.set_right(t);this.set_bottom(i);this.set_left(r)};h.__typeName="MultiSelectionCalendar.Rectangle";global.MultiSelectionCalendar.Rectangle=h;ss.initClass(f,u,{get_$id:function(){return this.$1$IdField},set_$id:function(n){this.$1$IdField=n},get_$xIdx:function(){return this.$1$XIdxField},set_$xIdx:function(n){this.$1$XIdxField=n},get_$yIdx:function(){return this.$1$YIdxField},set_$yIdx:function(n){this.$1$YIdxField=n},get_$date:function(){return this.$1$DateField},set_$date:function(n){this.$1$DateField=n},get_$tdElement:function(){return this.$1$TdElementField},set_$tdElement:function(n){this.$1$TdElementField=n},get_$currentClass:function(){return this.$dayFieldClass.toString()},set_$currentClass:function(n){this.$dayFieldClass=new e(n)},get_$divElement:function(){return this.$1$DivElementField},set_$divElement:function(n){this.$1$DivElementField=n},get_$isEnabled:function(){return this.$dayFieldClass.get_$isEnabledDay()},get_$isMouseEventBound:function(){return this.$1$IsMouseEventBoundField},set_$isMouseEventBound:function(n){this.$1$IsMouseEventBoundField=n},get_$selectionIdx:function(){return this.$dayFieldClass.get_$selectionIdx()}});f.$ctor1.prototype=f.prototype;ss.initClass(e,u,{get_$isSelectedMonth:function(){return this.$1$IsSelectedMonthField},set_$isSelectedMonth:function(n){this.$1$IsSelectedMonthField=n},get_$isEnabledDay:function(){return this.$1$IsEnabledDayField},set_$isEnabledDay:function(n){this.$1$IsEnabledDayField=n},get_$selectionIdx:function(){return this.$1$SelectionIdxField},set_$selectionIdx:function(n){this.$1$SelectionIdxField=n},toString:function(){return(this.get_$isSelectedMonth()?"cm":"om")+(this.get_$isEnabledDay()?"e":"d")+(this.get_$selectionIdx()>0?"s"+this.get_$selectionIdx():"")}});e.$ctor1.prototype=e.prototype;ss.initClass(o,u,{});ss.initClass(i,u,{});ss.initClass(t,u,{get_$calendarId:function(){return this.$1$CalendarIdField},set_$calendarId:function(n){this.$1$CalendarIdField=n},get_$calendarRootElement:function(){return this.$1$CalendarRootElementField},set_$calendarRootElement:function(n){this.$1$CalendarRootElementField=n},get_$inputElement:function(){return this.$1$InputElementField},set_$inputElement:function(n){this.$1$InputElementField=n},$addOldSelectedDateRanges:function(n){for(var c=this.$getSelectedRangesFromInputElement(this.get_$inputElement()),e=this.$_dayFields[0].get_$date(),o=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=Enumerable.from(this.$_dayFields).last().get_$date(),u=new Date(s.getFullYear(),s.getMonth(),s.getDate()),h=0;h<c.length;h++){var f=c[h],i=f.get_start(),t=f.get_end();i>=o?i<=u&&(i=Saltarelle.Utils.DateTimeExtension.addDaysSafe(u,1)):t>=o&&(t=Saltarelle.Utils.DateTimeExtension.addDaysSafe(o,-1),t>u&&n.push(new r(Saltarelle.Utils.DateTimeExtension.addDaysSafe(u,1),t,f.get_selectionIdx())));t>=i&&n.push(new r(i,t,f.get_selectionIdx()))}},$appendAdditionalRowsToBody:function(){var n=Enumerable.from(this.$_dayFields).last(),r=Saltarelle.Utils.DateTimeExtension.addDaysSafe(n.get_$date(),1),u=n.get_$id()+1,t=new ss.StringBuilder,i;this.$writeTDs(t,r,this.$getSelectedRangesFromInputElement(this.get_$inputElement()),u);i=this.$getTBody();i.append(t.toString());this.$updateDayFieldsMap();this.$bindEvents(!1)},$bindEvents:function(n){var r,u,f,e,t,i,c;if(!this.$_eventsBoundAfterMonthNavigation){if(r=this.$getPrevMonthLink(),u=this.$getNextMonthLink(),$(r).hasClass("enabled"))$(r).on("click",ss.mkdel(this,function(n){this.$onMonthNavigateClicked(n,!1)}));if($(u).hasClass("enabled"))$(u).on("click",ss.mkdel(this,function(n){this.$onMonthNavigateClicked(n,!0)}));this.$_eventsBoundAfterMonthNavigation=!0}if(!this.$_eventsBoundAfterCalenderInitialized){f=$(this.get_$calendarRootElement());$(window).on("mouseup",ss.mkdel(this,this.$onMouseUp));$(window).on("mousemove",ss.mkdel(this,this.$onMouseMove));$(window).on("dragend",ss.mkdel(this,this.$onMouseUp));f.on("dragstart",ss.mkdel(this,this.$onDragStart));f.on("mousewheel",ss.mkdel(this,this.$onMouseWheel));var l=this.get_$inputElement(),o={ntype:38,type:Element,name:"elem"},s={typeDef:Element,name:"Value",type:16,returnType:String,getter:{typeDef:Element,name:"get_Value",type:8,params:[],returnType:String,fget:"value"},setter:{typeDef:Element,name:"set_Value",type:8,params:[String],returnType:Object,fset:"value"},fname:"value"},h={ntype:23,type:s.returnType,expression:o,member:s};Saltarelle.Utils.StaticReflection.hookSetterOfProperty(Object,String).call(null,l,{ntype:18,type:Function,returnType:h.type,body:h,params:[o]},ss.mkdel(this,this.$onInputValueChanged));this.$_eventsBoundAfterCalenderInitialized=!0}if(e=Enumerable.from(this.$_dayFields).where(function(n){return n.get_$isEnabled()&&!n.get_$isMouseEventBound()}).toArray(),n){this.$_tBody=$("tBody",this.get_$calendarRootElement());this.$_tBody.on("mouseleave",ss.mkdel(this,this.$onMouseLeaveFromCalendar));this.$_tBody.on("mouseenter",ss.mkdel(this,this.$onMouseEnterIntoCalendar))}for(t=0;t<e.length;t++){i={$:e[t]};c=i.$.get_$tdElement();c.on("mousedown",ss.mkdel({dayField1:i,$this:this},function(n){this.$this.$onMouseDownInField(n,this.dayField1.$)}));i.$.set_$isMouseEventBound(!0)}},$calcScrollAnimationTime:function(n,t){var u=6,r=1,f,i;return f=t?this.$_mousePosY-this.$getBottomBorderOfCalendar():this.$getCalendarTop()-this.$_mousePosY,i=r+ss.Int32.div((u-r)*f,400),i<r?i=r:i>u&&(i=u),ss.Int32.trunc(ss.round(1e3*n/this.$getRowHeight()/i))},$doForEachDayField:function(n){var r=this.$_startSelectionField,i=this.$_endSelectionField,h=this.$getSelectionIdxFromInputField(),u,t,o,s;this.$_isSelectionModeOn?r.get_$id()>i.get_$id()&&(r=i,i=this.$_startSelectionField):(r=new f.$ctor1(1,1,1,new Date,""),i=new f.$ctor1(0,0,0,new Date,""));u=Enumerable.from(this.$_dayFields).where(function(n){return n.get_$isEnabled()}).getEnumerator();try{while(u.moveNext())if(t=u.current(),o=ss.isValue(this.$_weekSelectionModeActive)&&ss.unbox(this.$_weekSelectionModeActive)?t.get_$xIdx()>=r.get_$xIdx()&&t.get_$xIdx()<=i.get_$xIdx()&&t.get_$yIdx()>=r.get_$yIdx()&&t.get_$yIdx()<=i.get_$yIdx():t.get_$id()>=r.get_$id()&&t.get_$id()<=i.get_$id(),o){var c=t.get_$divElement().attr("class"),l=t.get_$date().getMonth()+1===this.$_firstDayOfActiveMonth.getMonth()+1&&t.get_$date().getFullYear()===this.$_firstDayOfActiveMonth.getFullYear(),a=new e.$ctor1(l,!0,h).toString();n(t,c,a,!0)}else s=t.get_$divElement().attr("class"),n(t,s,t.get_$currentClass(),!1)}finally{u.dispose()}},$finalizeSelection:function(){if(this.$_isSelectionModeOn){if(ss.referenceEquals(this.$_startSelectionField,this.$_endSelectionField)){var n=this.$_startSelectionField,t=this.$getSelectionIdxFromInputField(),i=n.$dayFieldClass.get_$selectionIdx()===t;i?(n.$dayFieldClass.set_$selectionIdx(0),n.get_$divElement().attr("class",n.get_$currentClass())):(n.$dayFieldClass.set_$selectionIdx(t),n.get_$divElement().attr("class",n.get_$currentClass()))}else this.$doForEachDayField(function(n,t,i){n.set_$currentClass(i)});this.$saveNewSelectedRangeStringInHiddenInput();this.$_isSelectionModeOn=!1;this.$_weekSelectionModeActive=null;this.$_startSelectionField=null;this.$_endSelectionField=null}},$getBodyHeight:function(){var n=ss.Int32.div(this.$_dayFields.length,7),t=this.$getRowHeight();return n*t},$getBottomBorderOfCalendar:function(){var n=$(this.get_$calendarRootElement()),t=n.offset().top;return t+n.outerHeight()},$getCalendarTop:function(){var n=$(this.get_$calendarRootElement()),t=$(".title",this.get_$calendarRootElement()),i=$("thead",this.get_$calendarRootElement());return n.offset().top+t.outerHeight()+i.outerHeight()},$getCurrentScrollY:function(){return this.$getTBody().scrollTop()},$getDayField:function(n){return Enumerable.from(this.$_dayFields).firstOrDefault(function(t){return t.get_$id()===n},ss.getDefaultValue(f))},$getFirstEnabledDay:function(){var n=Enumerable.from(this.$_enabledRanges).orderBy(function(n){return n.get_start()}).firstOrDefault(null,ss.getDefaultValue(r));return ss.isNullOrUndefined(n)?new Date(1940,0,1):n.get_start()},$getFirstSelectedDay:function(n){var u=this.$getSelectedRangesFromInputElement(n),i=Enumerable.from(u).orderBy(function(n){return n.get_start()}).firstOrDefault(null,ss.getDefaultValue(r)),t;return ss.isNullOrUndefined(i)?(t=this.$getFirstEnabledDay(),t>new Date)?t:new Date:i.get_start()},$getHtmlOfTable:function(n){var i,r;return this.$_currentEnabledRangesAsString=n.getAttribute("enabledRanges"),this.$_enabledRanges=t.getDateRangesFromString(this.$_currentEnabledRangesAsString),i=this.$getFirstSelectedDay(n),this.$_firstDayOfActiveMonth=new Date(i.getFullYear(),i.getMonth()+1-1,1),r=new ss.StringBuilder,this.$writeTemplateOfPicker(r,n),r.toString()},$getLastEnabledDay:function(){var n=Enumerable.from(this.$_enabledRanges).orderByDescending(function(n){return n.get_end()}).firstOrDefault(null,ss.getDefaultValue(r));return ss.isNullOrUndefined(n)?new Date(2100,0,1):n.get_end()},$getNextMonthLink:function(){var n=$("a.nextMonth",this.get_$calendarRootElement()).get(0);return ss.cast(n,ss.isValue(n)&&ss.isInstanceOfType(n,Element)&&n.tagName==="A")},$getPrevMonthLink:function(){var n=$("a.previousMonth",this.get_$calendarRootElement()).get(0);return ss.cast(n,ss.isValue(n)&&ss.isInstanceOfType(n,Element)&&n.tagName==="A")},$getRowHeight:function(){return this.$_rowHeight===0&&(this.$_rowHeight=$("td",this.get_$calendarRootElement()).first().outerHeight()),this.$_rowHeight},$getSelectionIdxFromInputField:function(){var t=this.get_$inputElement().getAttribute("selectionIdx"),n={};return ss.Int32.tryParse(t,n),n.$},$getSelectionIdxOfDay:function(n,t){var i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),u=Enumerable.from(t).firstOrDefault(function(n){return i>=n.get_start()&&i<=n.get_end()},ss.getDefaultValue(r));return ss.isNullOrUndefined(u)?0:u.get_selectionIdx()},$getSelectedRangesFromInputElement:function(n){return this.$_currentValueOfInputElement=n.value,t.getDateRangesFromString(n.value)},$getTBody:function(){return this.$_tBody},$getWeekDay:function(n){return t.$_weekdayNames[n]},$getViewportHeightOfBody:function(){var n=$(this.get_$calendarRootElement()),t=$(".title",this.get_$calendarRootElement()),i=$("thead",this.get_$calendarRootElement());return n.innerHeight()-t.outerHeight()-i.outerHeight()},$modifyHtml:function(n){var r=ss.safeCast(n.parentElement,ss.isValue(n.parentElement)&&ss.isInstanceOfType(n.parentElement,Element)&&n.parentElement.tagName==="DIV"),t,i,u;if(ss.isNullOrUndefined(r))throw new ss.Exception("input element must have a <div> element as parent !");t=$(r);t.addClass("multiSelectionCalendar");t.attr("calendarId",this.get_$calendarId().toString());i=$(n);i.removeClass("multiSelectionCalendar");i.addClass("hidden");u=this.$getHtmlOfTable(n);t.append(u)},$onDragStart:function(n){n.preventDefault()},$onInputValueChanged:function(n){ss.referenceEquals(this.$_currentValueOfInputElement,n)||this.$regenerateTable()},$onMonthNavigateClicked:function(n,t){var r=new ss.StringBuilder,i=$(".picker",this.get_$calendarRootElement()).get(0),f=ss.cast(i,ss.isValue(i)&&ss.isInstanceOfType(i,Element)&&i.tagName==="DIV"),u;this.$_firstDayOfActiveMonth=new Date(this.$_firstDayOfActiveMonth.getFullYear(),this.$_firstDayOfActiveMonth.getMonth()+(t?1:-1),this.$_firstDayOfActiveMonth.getDate(),this.$_firstDayOfActiveMonth.getHours(),this.$_firstDayOfActiveMonth.getMinutes(),this.$_firstDayOfActiveMonth.getSeconds(),this.$_firstDayOfActiveMonth.getMilliseconds());this.$writeTemplateOfPicker(r,this.get_$inputElement());u=$(f);u.replaceWith(r.toString());this.$_eventsBoundAfterMonthNavigation=!1;this.$updateEnableStatusOfMonthNavigation();this.$updateDayFieldsMap();this.$bindEvents(!0)},$onMouseDownInField:function(n,t){n.button===0&&(this.$_isSelectionModeOn=!0,this.$_startSelectionField=t,this.$_endSelectionField=t,this.$updateSelection())},$onMouseEnterIntoCalendar:function(){this.$_isMouseInsideCalendar=!0;this.$stopScroll()},$onMouseMove:function(n){var a=n.pageX,i=n.pageY,l,r,u,e;this.$_mousePosY=i;var o=this.$getTBody(),c=o.offset(),f=new s(c.left,c.top),t=new h(f.get_y(),f.get_x()+o.width(),f.get_y()+o.height(),f.get_x());t.get_width()!==0&&(l=this.$getCurrentScrollY(),r=ss.Int32.div((a-t.get_left())*7,t.get_width()),r<0?r=0:r>6&&(r=6),i>t.get_bottom()-10?i=t.get_bottom()-10:i<t.get_top()+10&&(i=t.get_top()+10),u=ss.Int32.div(i-t.get_top()+l,this.$getRowHeight()),u<0?u=0:u>ss.Int32.div(this.$_dayFields.length,7)&&(u=ss.Int32.div(this.$_dayFields.length,7)),e=this.$_dayFields[u*7+r],ss.referenceEquals(this.$_lastEnteredDayField,e)||(this.$_lastEnteredDayField=e,this.$onSelectionEnd(e)))},$onMouseLeaveFromCalendar:function(){this.$_isMouseInsideCalendar=!1;this.$_isSelectionModeOn&&this.$startScroll()},$onMouseUp:function(){this.$stopScroll();this.$finalizeSelection();this.$stopScroll()},$onMouseWheel:function(n){if(!this.$_scrollerIsRunning){var t=n,i=t.deltaY;t.stopImmediatePropagation();t.preventDefault();t.stopPropagation();this.$scrollImediately(i)}},$onSelectionEnd:function(n){this.$_isSelectionModeOn&&(ss.isValue(this.$_weekSelectionModeActive)||(n.get_$xIdx()===this.$_startSelectionField.get_$xIdx()?n.get_$yIdx()!==this.$_startSelectionField.get_$yIdx()&&(this.$_weekSelectionModeActive=!0):this.$_weekSelectionModeActive=!1),this.$_endSelectionField=n,this.$updateSelection())},$prependAdditionalRowsToBody:function(){var i=Enumerable.from(this.$_dayFields).first(),u=Saltarelle.Utils.DateTimeExtension.addDaysSafe(i.get_$date(),-49),f=i.get_$id()-49,r=new ss.StringBuilder,n;this.$writeTDs(r,u,this.$getSelectedRangesFromInputElement(this.get_$inputElement()),f);n=this.$getTBody();n.prepend(r.toString());n.scrollTop(n.scrollTop()+this.$getRowHeight()*t.$visibleCountOfRows);this.$updateDayFieldsMap();this.$bindEvents(!1)},$regenerateTable:function(){var n=this.$getHtmlOfTable(this.get_$inputElement());$(".picker",this.get_$calendarRootElement()).replaceWith(n);this.$_eventsBoundAfterMonthNavigation=!1;this.$updateEnableStatusOfMonthNavigation();this.$updateDayFieldsMap();this.$bindEvents(!0)},$saveNewSelectedRangeStringInHiddenInput:function(){var u=[],e,i,h,c,l,o;this.$addOldSelectedDateRanges(u);var f=null,s=null,n=0;for(e=0;e<this.$_dayFields.length;e++)i=this.$_dayFields[e],s=i,h=i.get_$selectionIdx(),h!==n&&(n!==0&&(c=new r(f.get_$date(),Saltarelle.Utils.DateTimeExtension.addDaysSafe(i.get_$date(),-1),n),u.push(c)),n=h,f=i);n!==0&&ss.isValue(s)&&ss.isValue(f)&&(l=new r(f.get_$date(),s.get_$date(),n),u.push(l));o=t.getStringFromDateRanges(u);this.$_currentValueOfInputElement=o;this.get_$inputElement().value=o;this.get_$inputElement().setAttribute("value",o);$(this.get_$inputElement()).trigger("change")},$scrollImediately:function(n){var t=0,i,r=ss.mkdel(this,function(){var u=!0;n:for(;;)switch(t){case 0:if(t=-1,this.$_scrollerIsRunning)return;t=1;continue n;case 1:case 2:case 3:t===1&&(t=2);try{t:for(;;)switch(t){case 2:t=-1;this.$_scrollerIsRunning=!0;i=this.$startNextScroll(n<0,!0);t=3;i.continueWith(r);u=!1;return;case 3:t=-1;i.getAwaitedResult();t=-1;break t;default:break t}}finally{u&&(this.$_scrollerIsRunning=!1)}t=-1;break n;default:break n}});r()},$startNextScroll:function(n,t){var i=0,e=new ss.TaskCompletionSource,r,c,u,l,f,a,v,o,s,y,p,h,w=ss.mkdel(this,function(){try{n:for(;;)switch(i){case 0:if(i=-1,r=50,c=this.$getBodyHeight(),u=this.$getCurrentScrollY(),l=this.$getViewportHeightOfBody(),n?(a=c-l,a<u+r&&this.$appendAdditionalRowsToBody(),f=u+r):(v=0,v>u-r&&this.$prependAdditionalRowsToBody(),f=this.$getCurrentScrollY()-r),t){this.$getTBody().scrollTop(f);i=-1;break n}else{o=this.$calcScrollAnimationTime(r,n);s={};s.scrollTop=f+"px";y=ss.Task.delay(o+100);p=ss.Task.fromDoneCallback(this.$getTBody(),"animate",s,o,"linear");h=ss.Task.whenAny([y,p]);i=1;h.continueWith(w);return}case 1:i=-1;h.getAwaitedResult();i=-1;break n;default:break n}e.setResult(null)}catch(b){e.setException(ss.Exception.wrap(b))}});return w(),e.task},$startScroll:function(){var n=0,t,i,e,r,u,f=ss.mkdel(this,function(){var o=!0;n:for(;;)switch(n){case 0:if(n=-1,this.$_scrollerIsRunning)return;this.$_scrollerIsRunning=!0;n=1;continue n;case 1:case 2:case 3:case 4:case 5:n===1&&(n=2);try{t:for(;;)switch(n){case 2:n=-1;t=10;n=3;continue t;case 3:if(n=-1,!(this.$_isSelectionModeOn&&!this.$_isMouseInsideCalendar&&this.$_scrollerIsRunning)){n=-1;break t}if(i=this.$getBottomBorderOfCalendar()<this.$_mousePosY+t,e=this.$getCalendarTop()>this.$_mousePosY+t,i||e){r=this.$startNextScroll(i,!1);n=4;r.continueWith(f);o=!1;return}u=ss.Task.delay(500);n=5;u.continueWith(f);o=!1;return;case 4:n=-1;r.getAwaitedResult();n=3;continue t;case 5:n=-1;u.getAwaitedResult();n=3;continue t;default:break t}}finally{o&&(this.$_scrollerIsRunning=!1)}n=-1;break n;default:break n}});f()},$stopScroll:function(){this.$getTBody().stop(!0)},$updateDayFieldsMap:function(){for(var r=Enumerable.from($("td",this.get_$calendarRootElement()).get()).select(function(n){return ss.cast(n,HTMLElement)}).toArray(),u=0,t=0;t<r.length;t++){var i=r[t],f=parseInt(i.id),e=ss.Int32.div(u,7),n=this.$getDayField(f);n.set_$yIdx(e);ss.isNullOrUndefined(n.get_$tdElement())&&(n.set_$tdElement($(i)),n.set_$divElement($("div",i).first()));u++}},$updateEnableStatusOfMonthNavigation:function(){var t=$(this.$getPrevMonthLink()),r=Saltarelle.Utils.DateTimeExtension.addDaysSafe(this.$_firstDayOfActiveMonth,-1),n,i;r<this.$getFirstEnabledDay()?(t.removeClass("enabled"),t.addClass("disabled")):(t.removeClass("disabled"),t.addClass("enabled"));n=$(this.$getNextMonthLink());i=new Date(this.$_firstDayOfActiveMonth.getFullYear(),this.$_firstDayOfActiveMonth.getMonth()+1,this.$_firstDayOfActiveMonth.getDate(),this.$_firstDayOfActiveMonth.getHours(),this.$_firstDayOfActiveMonth.getMinutes(),this.$_firstDayOfActiveMonth.getSeconds(),this.$_firstDayOfActiveMonth.getMilliseconds());i>this.$getLastEnabledDay()?(n.removeClass("enabled"),n.addClass("disabled")):(n.removeClass("disabled"),n.addClass("enabled"))},$updateSelection:function(){this.$_isSelectionModeOn&&this.$doForEachDayField(function(n,t,i){ss.referenceEquals(t,i)||n.get_$divElement().attr("class",i)})},$writeTDs:function(n,i,r,u){for(var h,a,s,o=i,l=0;l<t.$visibleCountOfRows;l++){for(n.appendLine("\t\t\t\t<tr>"),h=0;h<7;h++){var v=o.getMonth()+1===this.$_firstDayOfActiveMonth.getMonth()+1&&o.getFullYear()===this.$_firstDayOfActiveMonth.getFullYear(),y=new e.$ctor1(v,t.$isInRanges(this.$_enabledRanges,o),this.$getSelectionIdxOfDay(o,r)),c=new f(u,h,l,o,y);if(this.$_dayFields.length>0){if(a=c.get_$id(),Enumerable.from(this.$_dayFields).last().get_$id()<a)this.$_dayFields.push(c);else for(s=0;s<this.$_dayFields.length;s++)if(this.$_dayFields[s].get_$id()>a){ss.insert(this.$_dayFields,s,c);break}}else this.$_dayFields.push(c);t.$appendLin(n,'\t\t\t\t<td class="{3}" id="{2}"><div class=\'{1}\'>{0}<\/div><\/td>',[o.getDate(),y,u,v?"cm":"om"]);o=Saltarelle.Utils.DateTimeExtension.addDaysSafe(o,1);u++}n.appendLine("\t\t\t\t<\/tr>")}},$writeTemplateOfPicker:function(i,r){var s=this.$getSelectedRangesFromInputElement(r),f;ss.clear(this.$_dayFields);var h=1e4*this.get_$calendarId()+777,o=this.$_firstDayOfActiveMonth,e=o.getDay(),u=o;for(e!==1&&(u=e===0?Saltarelle.Utils.DateTimeExtension.addDaysSafe(u,-6):Saltarelle.Utils.DateTimeExtension.addDaysSafe(u,-e+1)),i.appendLine("\t<div class='picker'>"),i.appendLine("\t\t<div class='title text-center wrapper clearfix'>"),t.$appendLin(i,"\t\t\t<div class='pull-left'><a class='label text-center previousMonth' title='{0}' href='#'><span class='glyphicon glyphicon-backward iconPreviousMonth'><\/a><\/div>",[n.get_hintPreviousMonth()]),t.$appendLin(i,"\t\t\t{0} <b>{1}<\/b>",[t.$getNameOfMonth(this.$_firstDayOfActiveMonth.getMonth()+1),this.$_firstDayOfActiveMonth.getFullYear()]),t.$appendLin(i,"\t\t\t<div class='pull-right'><a class='label text-center nextMonth' title='{0}' href='#'><span class='glyphicon glyphicon-forward iconPreviousMonth'><\/a><\/div>",[n.get_hintNextMonth()]),i.appendLine("\t\t<\/div>"),i.appendLine("\t\t<table class='table'>"),i.appendLine("\t\t\t<thead>"),i.appendLine("\t\t\t\t<tr>"),f=0;f<7;f++)t.$appendLin(i,"\t\t\t\t\t<th><div>{0}<\/div><\/th>",[this.$getWeekDay(f)]);i.appendLine("\t\t\t\t<\/tr>");i.appendLine("\t\t\t<\/thead>");i.appendLine("\t\t\t<tbody>");this.$writeTDs(i,u,s,h);i.appendLine("\t\t\t<\/tbody>");i.appendLine("\t\t<\/table>");i.appendLine("\t<\/div>")}});ss.initClass(n,u,{});ss.initClass(s,u,{get_x:function(){return this.$1$XField},set_x:function(n){this.$1$XField=n},get_y:function(){return this.$1$YField},set_y:function(n){this.$1$YField=n}});ss.initClass(r,u,{get_start:function(){return this.$1$StartField},set_start:function(n){this.$1$StartField=n},get_end:function(){return this.$1$EndField},set_end:function(n){this.$1$EndField=n},get_selectionIdx:function(){return this.$1$SelectionIdxField},set_selectionIdx:function(n){this.$1$SelectionIdxField=n}});ss.initClass(h,u,{get_top:function(){return this.$1$TopField},set_top:function(n){this.$1$TopField=n},get_right:function(){return this.$1$RightField},set_right:function(n){this.$1$RightField=n},get_bottom:function(){return this.$1$BottomField},set_bottom:function(n){this.$1$BottomField=n},get_left:function(){return this.$1$LeftField},set_left:function(n){this.$1$LeftField=n},get_width:function(){return this.get_right()-this.get_left()},get_height:function(){return this.get_bottom()-this.get_top()},isInside:function(n){return n.get_x()>=this.get_left()&&n.get_x()<=this.get_right()&&n.get_y()>=this.get_top()&&n.get_y()<=this.get_bottom()}}),function(){n.$1$CurrentLanguageIsoCodeField=null}(),function(){t.$calendars=[];t.$visibleCountOfRows=7;t.$_weekdayNames=null}();o.$main()})()